var Path;

Path = require('path');

ﬁ.path.script.extend = Path.join(ﬁ.path.script.root, 'extend');

module.exports = function(library, context) {
  var Library, key, results, val;
  if (context == null) {
    context = 'script.extend';
  }
  if (!ﬁ.util.isString(library)) {
    throw new ﬁ.error('Invalid library.');
  }
  Library = ﬁ.require(context, library);
  if (!ﬁ[library] || !ﬁ.util.object.isDict(ﬁ[library])) {
    ﬁ.log.trace("Enabled '" + library + "' extend.");
    return ﬁ[library] = Library;
  }
  results = [];
  for (key in Library) {
    val = Library[key];
    ﬁ.log.trace("Setting '" + key + "' on top of ﬁ." + library + ".");
    results.push(ﬁ[library][key] = val);
  }
  return results;
};
